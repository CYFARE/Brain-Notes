## LDAP Pentesting

```
nmap -p 389 --script ldap-rootdse -Pn 1.2.3.4

nmap -p 389 --script ldap-search -Pn 1.2.3.4

ldapsearch -x -h 1.2.3.4 -s base namingcontexts

ldapsearch -x -h 1.2.3.4 -b "dc=lightweight,dc=htb"
```

| No. | Description                                       | Command                                                           |
|----:|---------------------------------------------------|-------------------------------------------------------------------|
|   1 | Enumerate Usernames                               | `ldapsearch -x -h 1.2.3.4 -b "dc=lightweight,dc=htb" "(objectclass=person)" cn` |
|   2 | Enumerate Groups                                  | `ldapsearch -x -h 1.2.3.4 -b "dc=lightweight,dc=htb" "(objectclass=group)" cn` |
|   3 | Anonymous Bind Check                             | `ldapsearch -x -h 1.2.3.4 -s base` |
|   4 | User Authentication Check                        | `ldapsearch -x -h 1.2.3.4 -D "cn=user,dc=lightweight,dc=htb" -w "password" -b "dc=lightweight,dc=htb" "(objectclass=*)"` |
|   5 | Enumerate User Attributes                         | `ldapsearch -x -h 1.2.3.4 -D "cn=user,dc=lightweight,dc=htb" -w "password" -b "dc=lightweight,dc=htb" "(&(objectclass=person)(cn=username))"` |
|   6 | Enumerate Group Members                           | `ldapsearch -x -h 1.2.3.4 -D "cn=user,dc=lightweight,dc=htb" -w "password" -b "dc=lightweight,dc=htb" "(&(objectclass=group)(cn=groupname))"` |
|   7 | User Account Lockout Status                      | `ldapsearch -x -h 1.2.3.4 -D "cn=user,dc=lightweight,dc=htb" -w "password" -b "dc=lightweight,dc=htb" "(&(objectclass=person)(cn=username)(lockoutTime>=1))"` |
|   8 | Directory Traversal Attack                       | `ldapsearch -x -h 1.2.3.4 -D "../../../../../../../../../../etc/passwd" -w "password" -b "dc=lightweight,dc=htb" "(objectclass=*)" ` |
|   9 | User Privilege Check                             | `ldapsearch -x -h 1.2.3.4 -D "cn=user,dc=lightweight,dc=htb" -w "password" -b "dc=lightweight,dc=htb" "(objectclass=person)" \| grep "memberOf:"` |
|  10 | Enumerate LDAP Server Information                | `ldapsearch -x -h 1.2.3.4 -s base` |
|  11 | Server Type and Version Check                    | `ldapsearch -x -h 1.2.3.4 -s base -b "" "objectclass=*"` |
|  12 | Empty Password Check                             | `ldapsearch -x -h 1.2.3.4 -D "cn=user,dc=lightweight,dc=htb" -w "" -b "dc=lightweight,dc=htb" "(objectclass=*)" ` |
|  13 | User Account Enumeration Using Error Messages   | `ldapsearch -x -h 1.2.3.4 -D "cn=invaliduser,dc=lightweight,dc=htb" -w "password" -b "dc=lightweight,dc=htb" "(objectclass=*)" ` |
